import numpy as np

ponto = [(-2.5,0.89),(-2.0,-1.18),(-1.5,1.88),(-1.0,4.06),(-0.5,1.21)]
pont = [(-2.5,-3.99), (-2.0,-5.26), (-1.5,0.54), (-1.0,-4.29), (-0.5,-2.59), (0.0,-0.95), (0.5,-0.15)]
pon = [(-2.5,0.94), (-2.0,-3.08), (-1.5,5.33), (-1.0,2.57), (-0.5,-5.94), (0.0,4.39), (0.5,-2.35), (1.0,0.17), (1.5,5.38),
(2.0,-1.13), (2.5,-2.63)]
pontos = [(-2.5,-5.6), (-2.0,-4.03), (-1.5,-0.4), (-1.0,-1.12), (-0.5,1.51), (0.0,2.98), (0.5,-4.59), (1.0,0.56), (1.5,-4.43),
(2.0,-5.53), (2.5,2.14), (3.0,4.02), (3.5,0.85), (4.0,1.37), (4.5,5.26), (5.0,2.79), (5.5,5.16), (6.0,-2.28), (6.5,-2.9),
(7.0,-0.61), (7.5,-3.93), (8.0,2.04), (8.5,5.61), (9.0,-2.09), (9.5,1.55), (10.0,-0.59), (10.5,-5.47), (11.0,-5.5),
(11.5,2.64), (12.0,2.0), (12.5,5.1)]
n = len(pontos)

print ("Questão 6 - Polinômio Interpolador dos pontos \n")
print ("    Pontos 2 - ",pontos,"\n")

def vandermond(pontos):
    xs, ys = zip(*pontos)
    A = [[x ** k for k in range(n)] for x in xs]
    B = ys
    a = np.linalg.solve(A, B)
    print ("    ",a)
    return a

a = vandermond(pontos)

def p(x):
    px = sum([a[k] * x ** k for k in range(n)])
    return px

def sign(x):
    
    if x < 0:
        print ("    Coeficientes - ",x)
        return str(x)
    print ("    Coeficientes - ",f'+{x}')
    return f'+{x}'


def equation(pontos):
    eq = "P(x) = "
    eq += "".join([f'{sign(a[k])}*x**{k}' for k in range(n)])
    return eq

eq = equation(pontos)
print("    ",eq,"\n\n")

"""

Questão 6 - Polinômio Interpolador dos pontos 1

    Pontos 1 -  [(-2.5, 0.89), (-2.0, -1.18), (-1.5, 1.88), (-1.0, 4.06), (-0.5, 1.21)]

     [ -8.96       -28.25666667 -15.81         0.66666667   1.24      ]
    Coeficientes -  -8.959999999999994
    Coeficientes -  -28.25666666666666
    Coeficientes -  -15.810000000000002
    Coeficientes -  +0.6666666666666643
    Coeficientes -  +1.2399999999999995
     P(x) = -8.959999999999994*x**0-28.25666666666666*x**1-15.810000000000002*x**2+0.6666666666666643*x**3+1.2399999999999995*x**4



Questão 6 - Polinômio Interpolador dos pontos 2

    Pontos 2 -  [(-2.5, -3.99), (-2.0, -5.26), (-1.5, 0.54), (-1.0, -4.29), (-0.5, -2.59), (0.0, -0.95), (0.5, -0.15)]

     [ -0.95        -7.10233333 -20.31066667  27.38166667  72.56333333
  43.15066667   7.83733333]
    Coeficientes -  -0.9500000000015447
    Coeficientes -  -7.102333333334499
    Coeficientes -  -20.310666666665774
    Coeficientes -  +27.381666666671027
    Coeficientes -  +72.56333333333804
    Coeficientes -  +43.15066666666871
    Coeficientes -  +7.837333333333647
     P(x) = -0.9500000000015447*x**0-7.102333333334499*x**1-20.310666666665774*x**2+27.381666666671027*x**3+72.56333333333804*x**4+43.15066666666871*x**5+7.837333333333647*x**6



Questão 6 - Polinômio Interpolador dos pontos 3

    Pontos 3 -  [(-2.5, 0.94), (-2.0, -3.08), (-1.5, 5.33), (-1.0, 2.57), (-0.5, -5.94), (0.0, 4.39), (0.5, -2.35), (1.0, 0.17), (1.5, 5.38), (2.0, -1.13), (2.5, -2.63)]

     [  4.39         7.08778571 -53.74841349 -16.42679101  90.04252249
  10.32088889 -48.99646667  -2.35695238  10.4311746    0.17506878
  -0.74881693]
    Coeficientes -  +4.389999999998508
    Coeficientes -  +7.087785714285474
    Coeficientes -  -53.74841349206443
    Coeficientes -  -16.426791005292426
    Coeficientes -  +90.0425224867711
    Coeficientes -  +10.320888888890266
    Coeficientes -  -48.99646666666502
    Coeficientes -  -2.3569523809527517
    Coeficientes -  +10.431174603174144
    Coeficientes -  +0.17506878306881313
    Coeficientes -  -0.7488169312168934
     P(x) = +4.389999999998508*x**0+7.087785714285474*x**1-53.74841349206443*x**2-16.426791005292426*x**3+90.0425224867711*x**4+10.320888888890266*x**5-48.99646666666502*x**6-2.3569523809527517*x**7+10.431174603174144*x**8+0.17506878306881313*x**9-0.7488169312168934*x**10



Questão 6 - Polinômio Interpolador dos pontos 4

    Pontos 4 -  [(-2.5, -5.6), (-2.0, -4.03), (-1.5, -0.4), (-1.0, -1.12), (-0.5, 1.51), (0.0, 2.98), (0.5, -4.59), (1.0, 0.56), (1.5, -4.43), (2.0, -5.53), (2.5, 2.14), (3.0, 4.02), (3.5, 0.85), (4.0, 1.37), (4.5, 5.26), (5.0, 2.79), (5.5, 5.16), (6.0, -2.28), (6.5, -2.9), (7.0, -0.61), (7.5, -3.93), (8.0, 2.04), (8.5, 5.61), (9.0, -2.09), (9.5, 1.55), (10.0, -0.59), (10.5, -5.47), (11.0, -5.5), (11.5, 2.64), (12.0, 2.0), (12.5, 5.1)]

     [ 4.65733581e+00 -6.40803330e+01 -1.31088476e+01  2.66801336e+02
 -1.67336620e+02 -2.60584607e+02  2.95720092e+02  1.52179389e+01
 -1.40536694e+02  5.51173833e+01  1.37207091e+01 -1.61797534e+01
  3.75056259e+00  6.97761220e-01 -6.02761737e-01  1.36956641e-01
 -3.69601624e-03 -5.78031939e-03  1.73269258e-03 -2.72478265e-04
  2.62254614e-05 -1.39826501e-06  1.12133394e-08  3.07417810e-09
 -4.81598403e-12 -3.16072773e-11  3.24424442e-12 -1.70531580e-13
  5.27387307e-15 -9.15434876e-17  6.91991946e-19]
    Coeficientes -  +4.6573358086204735
    Coeficientes -  -64.08033300980719
    Coeficientes -  -13.108847557659157
    Coeficientes -  +266.80133574914885
    Coeficientes -  -167.33662018532627
    Coeficientes -  -260.5846073018189
    Coeficientes -  +295.7200917626444
    Coeficientes -  +15.21793886965189
    Coeficientes -  -140.53669449191673
    Coeficientes -  +55.117383310692
    Coeficientes -  +13.720709093342922
    Coeficientes -  -16.179753397194084
    Coeficientes -  +3.750562591072415
    Coeficientes -  +0.6977612201482595
    Coeficientes -  -0.6027617367010735
    Coeficientes -  +0.13695664091274934
    Coeficientes -  -0.0036960162419943502
    Coeficientes -  -0.005780319393742492
    Coeficientes -  +0.0017326925754780982
    Coeficientes -  -0.0002724782649591502
    Coeficientes -  +2.6225461409504568e-05
    Coeficientes -  -1.39826500552863e-06
    Coeficientes -  +1.1213339432935577e-08
    Coeficientes -  +3.074178095829955e-09
    Coeficientes -  -4.815984030248781e-12
    Coeficientes -  -3.1607277308580096e-11
    Coeficientes -  +3.244244420676333e-12
    Coeficientes -  -1.7053158016437178e-13
    Coeficientes -  +5.273873066902973e-15
    Coeficientes -  -9.154348761815908e-17
    Coeficientes -  +6.919919461514469e-19
     P(x) = +4.6573358086204735*x**0-64.08033300980719*x**1-13.108847557659157*x**2+266.80133574914885*x**3-167.33662018532627*x**4-260.5846073018189*x**5+295.7200917626444*x**6+15.21793886965189*x**7-140.53669449191673*x**8+55.117383310692*x**9+13.720709093342922*x**10-16.179753397194084*x**11+3.750562591072415*x**12+0.6977612201482595*x**13-0.6027617367010735*x**14+0.13695664091274934*x**15-0.0036960162419943502*x**16-0.005780319393742492*x**17+0.0017326925754780982*x**18-0.0002724782649591502*x**19+2.6225461409504568e-05*x**20-1.39826500552863e-06*x**21+1.1213339432935577e-08*x**22+3.074178095829955e-09*x**23-4.815984030248781e-12*x**24-3.1607277308580096e-11*x**25+3.244244420676333e-12*x**26-1.7053158016437178e-13*x**27+5.273873066902973e-15*x**28-9.154348761815908e-17*x**29+6.919919461514469e-19*x**30




"""